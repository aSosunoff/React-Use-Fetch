{"version":3,"sources":["webpack:///./index.ts","webpack:///external \"react\"","webpack:///webpack/bootstrap","webpack:///webpack/startup"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import {\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from \"react\";\n\ntype Action<K extends string, V = void> = V extends void\n  ? { type: K }\n  : { type: K } & V;\n\ntype ActionFetch<T> =\n  | Action<\"request\">\n  | Action<\"success\", { payload: T }>\n  | Action<\"failure\", { payload: any }>;\n\nexport interface State<T, TError = any> {\n  status: \"init\" | \"request\" | \"failure\" | \"success\";\n  data?: T;\n  error?: TError;\n}\n\ninterface Cache<T> {\n  [url: string]: T;\n}\n\nexport const useFetch = <TData, TError = any>(\n  url: string,\n  isCache = false\n): [State<TData, TError>, (options?: RequestInit) => void] => {\n  const [options, setOptions] = useState<RequestInit>();\n\n  const cache = useRef<Cache<TData>>({});\n\n  const [isFetch, setFetch] = useState(false);\n\n  const initialState = useMemo<State<TData, TError>>(\n    () => ({\n      status: \"init\",\n      error: undefined,\n      data: undefined,\n    }),\n    []\n  );\n\n  const fetchReducer = useCallback(\n    (\n      state: State<TData, TError>,\n      action: ActionFetch<TData>\n    ): State<TData, TError> => {\n      switch (action.type) {\n        case \"request\":\n          return { ...initialState, status: \"request\" };\n        case \"success\":\n          return { ...initialState, status: \"success\", data: action.payload };\n        case \"failure\":\n          return { ...initialState, status: \"failure\", error: action.payload };\n        default:\n          return state;\n      }\n    },\n    [initialState]\n  );\n\n  const [state, dispatch] = useReducer(fetchReducer, initialState);\n  const request = useCallback(() => dispatch({ type: \"request\" }), []);\n  const success = useCallback(\n    (payload) => dispatch({ type: \"success\", payload }),\n    []\n  );\n  const failure = useCallback(\n    (payload) => dispatch({ type: \"failure\", payload }),\n    []\n  );\n\n  useEffect(() => {\n    if (!url || !isFetch) {\n      return;\n    }\n\n    let cancelRequest = false;\n\n    (async () => {\n      request();\n\n      if (isCache && cache.current[url]) {\n        setFetch(() => false);\n        !cancelRequest && success(cache.current[url]);\n        return;\n      }\n\n      try {\n        const response = await fetch(url, options);\n        const data = await response.json();\n\n        if (!cancelRequest) {\n          cache.current[url] = data;\n          setFetch(() => false);\n          success(data);\n        }\n      } catch (error) {\n        if (!cancelRequest) {\n          setFetch(() => false);\n          failure(error);\n        }\n      }\n    })();\n\n    return () => {\n      cancelRequest = true;\n    };\n  }, [failure, isCache, isFetch, options, request, success, url]);\n\n  const doFetch = useCallback((options?: RequestInit) => {\n    setOptions(() => options);\n    setFetch(() => true);\n  }, []);\n\n  return [state, doFetch];\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__297__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(447);\n"],"sourceRoot":""}